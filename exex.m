clear all

a=fopen('igen_vaule.txt','r');
igen=fscanf(a,'%f');

L=330.7;
pe=1;
v=34.0;
D=1000;
pb=1.6;
se=0.2;
k1=0.784;
R1=7.27;
B1=0.5;
ram=2;
c1o=0.056;
c2=0;
%igen=[-59.70664	 -59.69023	-44.00507	-43.98242	-37.72559	-37.69902	-28.30957	-28.27441	-22.03652	-21.99121	-18.90244	-18.84951	-12.64541	-12.56631	-9.529639	-9.424755	-6.438231	-6.283154	-3.431029	-3.141576	-9.60E-01	9.60E-01	3.141578	3.431031	6.283155	6.438233	9.424757	9.529641	12.56631	12.64541	18.84951	18.90244	21.99121	22.03653	28.27441	28.30957	37.69902	37.72559	43.98242	44.00507	59.69023	59.70664];

syms x s
%x=1
%s=1

th=s+ram+( (B1/se).*(  (s.*k1.*pb)/(s.*k1.*pb+B1)  ) );
%th(s)=s+ram+( (B1/se).*(  (s.*k1.*pb)/(s.*k1.*pb+B1)  ) )

for i=1:98
c1(i)=( ( (pe.*sin(igen(i).*x))+(2.*igen(i).*cos(igen(i).*x) ) ) /(  (pe.^2/4)+pe+(igen(i)^2) )  ).* ( (-c1o./s).*( (th.*((pe.*igen(i))./ ((pe^2/4)+(igen(i)^2))))/ (th+(pe./4)+((igen(i)^2)./pe))) );
%c1=( ( (pe.*sin(igen.*x))+(2.*igen.*cos(igen.*x) ) ) /(  (pe.^2/4)+pe+(igen^2) )  ).* ( (-c1o./s).*( (th.*((pe.*igen)./ ((pe^2/4)+(igen^2))))/ (th+(pe./4)+((igen^2)./pe))) ) 
end
con=(sum(c1,'all').*( exp((-pe.*x)/2) )) + (c1o./s);
F=ilaplace(con);

syms x t
u=subs(F, t, 1)

%for m=1:1:350
%q(m)=subs(F, [x, t], [m, 1])
%end


%for m=1:1:350   
%subs(F, x, m); 
%plot(m,F)
%hold on
%end


